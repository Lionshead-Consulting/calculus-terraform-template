{
  "provider": {
    "aws": {
      "region": "${var.region}"
    }
  },
  "resource": [
    {
      "aws_s3_bucket_object": {
        "fnS3": {
          "key": "%FunctionName%.zip",
          "source": "../%FunctionName%.zip",
          "bucket": "${var.bucket}",
          "etag":"${md5(file(\"../%FunctionName%.zip\"))}"
        }
      }
    },
    {
      "aws_lambda_function": {
        "calculus_generated_function": {
          "function_name": "%FunctionName%",
          "role": "${var.role}",
          "runtime": "nodejs6.10",
          "s3_bucket": "%Bucket%",
          "s3_key": "%FunctionName%.zip",
          "s3_object_version": "${aws_s3_bucket_object.fnS3.version_id}",
          "handler": "index.handler",
          "publish": true,
          "memory_size": "${var.memory_size}",
          "timeout": "${var.timeout}",
          "environment": {
            "variables": {
              "NODE_ENV": "%NODE_ENV%"
            }
          }
        }
      }
    }
  ]
}
